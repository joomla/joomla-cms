!function(t){"use strict";window.tinymce={langCode:"en",langStrings:{},addI18n:function(t,e){this.langCode=t,this.langStrings=e||{}},translate:function(t){return this.langStrings[t]?this.langStrings[t]:t}};var e=function(e,n){this.$container=t(e),this.options=n,this.$sourceMenu=this.$container.find(".timymce-builder-menu.source"),this.$sourceToolbar=this.$container.find(".timymce-builder-toolbar.source"),this.$targetMenu=this.$container.find(".timymce-builder-menu.target"),this.$targetToolbar=this.$container.find(".timymce-builder-toolbar.target"),this.$sourceMenu.each(function(t,e){this.renderBar(e,"menu")}.bind(this)),this.$sourceToolbar.each(function(t,e){this.renderBar(e,"toolbar")}.bind(this)),this.$targetMenu.each(function(t,e){this.renderBar(e,"menu",null,!0)}.bind(this)),this.$targetToolbar.each(function(t,e){this.renderBar(e,"toolbar",null,!0)}.bind(this));var i=null,a=!1,o=this;this.$sourceMenu.sortable({connectWith:this.$targetMenu,items:".mce-btn",cancel:"",placeholder:"mce-btn ui-state-highlight",start:function(t,e){o.$targetMenu.addClass("drop-area-highlight")},helper:function(t,e){return i=e.clone().insertAfter(e),e},stop:function(){i&&i.remove(),o.$targetMenu.removeClass("drop-area-highlight")}}),this.$sourceToolbar.sortable({connectWith:this.$targetToolbar,items:".mce-btn",cancel:"",placeholder:"mce-btn ui-state-highlight",start:function(t,e){o.$targetToolbar.addClass("drop-area-highlight")},helper:function(t,e){return i=e.clone().insertAfter(e),e},stop:function(){i&&i.remove(),o.$targetToolbar.removeClass("drop-area-highlight")}}),t().add(this.$targetMenu).add(this.$targetToolbar).sortable({items:".mce-btn",cancel:"",placeholder:"mce-btn ui-state-highlight",receive:function(e,n){i=null;var a=n.item,r=t(this);o.appendInput(a,r.data("group"),r.data("set"))},over:function(t,e){a=!1},out:function(t,e){a=!0},beforeStop:function(t,e){a&&e.item.remove()}}),this.$container.on("click",".button-action",function(e){var n=t(e.target),i=n.data("action"),a=n.data();if(!this[i])throw new Error("Unsupported action "+i);this[i].call(this,a)}.bind(this))};e.prototype.renderBar=function(e,n,i,a){for(var o,r,s,l=t(e),c=l.data("group"),u=l.data("set"),h="menu"===n?this.options.menus:this.options.buttons,d=0,p=(i=i||(l.data("value")||[])).length;d<p;d++)(o=h[r=i[d]])&&(s=this.createButton(r,o,n),l.append(s),s.tooltip&&s.tooltip({trigger:"hover"}),a&&this.appendInput(s,c,u))},e.prototype.createButton=function(e,n,i){var a=t("<div />",{class:"mce-btn","data-name":e,"data-toggle":"tooltip",title:tinymce.translate(n.label)}),o=t("<button/>",{type:"button"});return a.append(o),"menu"===i?o.html('<span class="mce-txt">'+tinymce.translate(n.label)+'</span> <i class="mce-caret"></i>'):(a.addClass("mce-btn-small"),o.html(n.text?tinymce.translate(n.text):'<i class="mce-ico mce-i-'+e+'"></i>')),a},e.prototype.appendInput=function(e,n,i){var a=t(e),o=this.options.formControl+"["+i+"]["+n+"][]",r=t("<input/>",{type:"hidden",name:o,value:a.data("name")});a.append(r)},e.prototype.setPreset=function(t){var e,n,i=t.set,a=this.options.toolbarPreset[t.preset]||null;if(!a)throw new Error('Unknown Preset "'+t.preset+'"');for(var o in a)a.hasOwnProperty(o)&&("menu"===o?(n="menu",e=this.$targetMenu.filter('[data-group="'+o+'"][data-set="'+i+'"]')):(n="toolbar",e=this.$targetToolbar.filter('[data-group="'+o+'"][data-set="'+i+'"]')),e.empty(),this.renderBar(e,n,a[o],!0))},e.prototype.clearPane=function(t){var e=t.set;this.$targetMenu.filter('[data-set="'+e+'"]').empty(),this.$targetToolbar.filter('[data-set="'+e+'"]').empty()},t(document).ready(function(){var n=Joomla.getOptions?Joomla.getOptions("plg_editors_tinymce_builder",{}):Joomla.optionsStorage.plg_editors_tinymce_builder||{};new e(t("#joomla-tinymce-builder"),n),t("#set-tabs a").on("click",function(e){e.preventDefault(),t(this).tab("show")});var i=t("#joomla-tinymce-builder").find(".access-select");function a(){i.find("option[disabled]").removeAttr("disabled"),i.each(function(){for(var e=t(this).val()||[],n=[],a=i.not(this).find("option"),o=0,r=e.length;o<r;o++)e[o]&&n.push('[value="'+e[o]+'"]');n.length&&a.filter(n.join(",")).attr("disabled","disabled")}),i.trigger("liszt:updated")}a(),i.on("change",function(){a()})})}(jQuery);