!function(a,b){"use strict";window.ImageManager={initialize:function(){var c=this.getUriObject(window.self.location.href),d=this.getQueryObject(c.query);this.editor=decodeURIComponent(d.e_name),this.fields={url:b.getElementById("f_url"),alt:b.getElementById("f_alt"),align:b.getElementById("f_align"),title:b.getElementById("f_title"),caption:b.getElementById("f_caption"),c_class:b.getElementById("f_caption_class")},this.folderlist=b.getElementById("folderlist"),this.frame=window.frames.imageframe,this.frameurl=this.frame.location.href,a("#imageframe").on("load",function(){ImageManager.onloadimageview()}),a("#upbutton").off("click").on("click",function(){ImageManager.upFolder()})},onloadimageview:function(){var e,f,b=this.getImageFolder(),c=a("#uploadForm"),d="";this.frameurl=this.frame.location.href,this.setFolder(b),e=this.getUriObject(c.attr("action")),f=this.getQueryObject(e.query),f.folder=b,e.query=a.param(f),"undefined"!=typeof e.port&&80!=e.port&&(d=":"+e.port),c.attr("action",e.scheme+"://"+e.domain+d+e.path+"?"+e.query)},getImageFolder:function(){return this.getQueryObject(this.frame.location.search.substring(1)).folder},onok:function(){var a="",b=[],c="",d="",e=this.fields.url.value,f=this.fields.alt.value,g=this.fields.align.value,h=this.fields.title.value,i=this.fields.caption.value,j=this.fields.c_class.value;return e&&(b.push('alt="'+f+'"'),g&&!i&&b.push('class="float-xs-'+g+'"'),h&&b.push('title="'+h+'"'),a='<img src="'+e+'" '+b.join(" ")+"/>",i&&(g&&(c=' class="float-xs-'+g+'"'),j&&(d=' class="'+j+'"'),a="<figure"+c+">"+a+"<figcaption"+d+">"+i+"</figcaption></figure>")),window.Joomla&&Joomla.editors.instances.hasOwnProperty(this.editor)?Joomla.editors.instances[editor].replaceSelection(a):window.parent.jInsertEditorText(a,this.editor),!0},setFolder:function(b,c,d){for(var e=0,f=this.folderlist.length;e<f;e++)if(b==this.folderlist.options[e].value){this.folderlist.selectedIndex=e,a(this.folderlist).trigger("liszt:updated").trigger("chosen:updated");break}(c||d)&&this.setFrameUrl(b,c,d)},upFolder:function(){var b,a=this.folderlist.value.split("/");a.pop(),b=a.join("/"),this.setFolder(b),this.setFrameUrl(b)},populateFields:function(b){a.each(a("a.img-preview",a("#imageframe").contents()),function(c,d){d.href=="javascript:ImageManager.populateFields('"+b+"')"?a(d,a("#imageframe").contents()).addClass("selected"):a(d,a("#imageframe").contents()).removeClass("selected")}),a("#f_url").val(image_base_path+b)},showMessage:function(b){var c=a("#message");c.find(">:first-child").remove(),c.append(b),a("#messages").css("display","block")},refreshFrame:function(){this.frame.location.href=this.frameurl},setFrameUrl:function(b,c,d){var e={option:"com_media",view:"imagesList",tmpl:"component",asset:c,author:d};this.frameurl="index.php?"+a.param(e)+"&folder="+b,this.frame.location.href=this.frameurl},getQueryObject:function(b){var c={};return a.each((b||"").split(/[&;]/),function(a,b){var d=b.split("=");c[d[0]]=2==d.length?d[1]:null}),c},getUriObject:function(b){var c={},d=b.match(/^(?:([^:\/?#.]+):)?(?:\/\/)?(([^:\/?#]*)(?::(\d*))?)((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[\?#]|$)))*\/?)?([^?#\/]*))?(?:\?([^#]*))?(?:#(.*))?/);return a.each(["uri","scheme","authority","domain","port","path","directory","file","query","fragment"],function(a,b){c[b]=d&&d[a]?d[a]:""}),c}},a(function(){window.ImageManager.initialize()})}(jQuery,document);
