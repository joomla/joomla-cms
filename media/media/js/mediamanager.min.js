(function(e,t){"use strict";function r(t){var n={};return t=t||"",e.each(t.split(/[&;]/),function(e,t){var r=t.split("=");n[decodeURIComponent(r[0])]=r.length==2?decodeURIComponent(r[1]):null}),n}function i(t){var n={},r=t.match(/^(?:([^:\/?#.]+):)?(?:\/\/)?(([^:\/?#]*)(?::(\d*))?)((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[\?#]|$)))*\/?)?([^?#\/]*))?(?:\?([^#]*))?(?:#(.*))?/);return e.each(["uri","scheme","authority","domain","port","path","directory","file","query","fragment"],function(e,t){n[t]=!r||!r[e]?"":r[e]}),n}function s(e){return e.scheme+"://"+e.domain+(e.port?":"+e.port:"")+(e.path?e.path:"/")+(e.query?"?"+e.query:"")+(e.fragment?"#"+e.fragment:"")}var n=t.MediaManager={initialize:function(){this.folderpath=e("#folderpath"),this.updatepaths=e("input.update-folder"),this.frame=window.frames.folderframe,this.frameurl=this.frame.location.href,this.setTreeviewState()},submit:function(t){var n=this.frame.document.getElementById("mediamanager-form");n.task.value=t,n.action+="&controller="+t,e("#username").length&&(n.username.value=e("#username").val(),n.password.value=e("#password").val()),n.submit()},submitWithTargetPath:function(t){var n=window.frames.folderframe.document.getElementById("mediamanager-form");n.task.value=t,n.action+="&controller="+t,e("#username").length&&(n.username.value=e("#username").val(),n.password.value=e("#password").val());var r=document.createElement("input");r.type="hidden",r.name="targetPath";var i=t.split(".")[1];i=="copy"?r.value=e("#copyTarget #folderlist").find(":selected").text():i=="move"&&(r.value=e("#moveTarget #folderlist").find(":selected").text()),n.appendChild(r),n.submit()},onloadframe:function(){this.frameurl=this.frame.location.href;var t=this.getFolder()||"",n=[],s=i(e("#uploadForm").attr("action")),o=r(s.query),u,a;this.updatepaths.each(function(e,n){n.value=t}),this.folderpath.val(basepath+(t?"/"+t:"/")),o.folder=t;for(u in o){if(!o.hasOwnProperty(u))continue;a=o[u],n.push(u+(a===null?"":"="+a))}s.query=n.join("&"),s.fragment=null,e("#"+viewstyle).addClass("active")},setViewType:function(t){e("#"+t).addClass("active"),e("#"+viewstyle).removeClass("active"),viewstyle=t;var n=this.getFolder();this.setFrameUrl("index.php?option=com_media&view=mediaList&tmpl=component&folder="+n+"&layout="+t)},refreshFrame:function(){this.setFrameUrl()},getFolder:function(){var e=r(this.frame.location.search.substring(1));return e.folder=e.folder===undefined?"":e.folder,e.folder},setFrameUrl:function(e){e!==null&&(this.frameurl=e),this.frame.location.href=this.frameurl},setTreeviewState:function(){if(typeof Storage!="undefined")var e=localStorage.getItem("jsidebar");e=e=="true"?!0:!1;var t=jQuery("#j-sidebar-container").attr("class");t.contains("j-toggle-hidden")||e?jQuery("#treeview").attr("hidden",!0):jQuery("#treeview").attr("hidden",!1)}};e(function(){n.initialize(),document.updateUploader=function(){n.onloadframe()},n.onloadframe()})})(jQuery,window);