!function t(e,r,n){function a(o,u){if(!r[o]){if(!e[o]){var l="function"==typeof require&&require;if(!u&&l)return l(o,!0);if(i)return i(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var b=r[o]={exports:{}};e[o][0].call(b.exports,function(t){var r=e[o][1][t];return a(r||t)},b,b.exports,t,e,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)a(n[o]);return a}({1:[function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var r,n=0;n<e.length;n++)(r=e[n]).enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();!function(t){function e(t,e){for(var r;t;){if((r=t.parentElement)&&r[i](e))return r;t=r}return null}var r={SPACE:32,ESC:27,ENTER:13},i="matches";["matches","msMatchesSelector"].some(function(t){return!("function"!=typeof document.body[t]||(i=t,0))});var o=function(t){function o(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=(void 0===e?"undefined":n(e))&&"function"!=typeof e?t:e}(this,(o.__proto__||Object.getPrototypeOf(o)).call(this)),a=t;if(t.containerWithRows=t,t.rowsContainer)for(var u=t.querySelectorAll(t.rowsContainer),l=0,s=u.length;l<s;l++)if(e(u[l],"joomla-field-subform")===t){t.containerWithRows=u[l];break}return t.lastRowNum=t.getRows().length,t.template="",t.prepareTemplate(),(t.buttonAdd||t.buttonRemove)&&(t.addEventListener("click",function(t){var r=null,n=null;if(a.buttonAdd&&(r=t.target[i](a.buttonAdd)?t.target:e(t.target,a.buttonAdd)),a.buttonRemove&&(n=t.target[i](a.buttonRemove)?t.target:e(t.target,a.buttonRemove)),r&&e(r,"joomla-field-subform")===a){var o=e(r,a.repeatableElement);o=e(o,"joomla-field-subform")===a?o:null,a.addRow(o),t.preventDefault()}else if(n&&e(n,"joomla-field-subform")===a){var u=e(n,a.repeatableElement);a.removeRow(u),t.preventDefault()}}),t.addEventListener("keydown",function(t){if(t.keyCode===r.SPACE){var n=a.buttonAdd&&t.target[i](a.buttonAdd),o=a.buttonRemove&&t.target[i](a.buttonRemove);if((n||o)&&e(t.target,"joomla-field-subform")===a){var u=e(t.target,a.repeatableElement);u=e(u,"joomla-field-subform")===a?u:null,o&&u?a.removeRow(u):n&&a.addRow(u),t.preventDefault()}}})),t.buttonMove&&t.setUpDragSort(),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":n(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(o,HTMLElement),a(o,[{key:"buttonAdd",get:function(){return this.getAttribute("button-add")}},{key:"buttonRemove",get:function(){return this.getAttribute("button-remove")}},{key:"buttonMove",get:function(){return this.getAttribute("button-move")}},{key:"rowsContainer",get:function(){return this.getAttribute("rows-container")}},{key:"repeatableElement",get:function(){return this.getAttribute("repeatable-element")}},{key:"minimum",get:function(){return this.getAttribute("minimum")}},{key:"maximum",get:function(){return this.getAttribute("maximum")}},{key:"name",get:function(){return this.getAttribute("name")},set:function(t){return this.template=this.template.replace(new RegExp(' name="'+this.name.replace(/[\[\]]/g,"\\$&"),"g"),' name="'+t),this.setAttribute("name",t)}}]),a(o,[{key:"getRows",value:function(){for(var t=this.containerWithRows.children,e=document.body.msMatchesSelector?"msMatchesSelector":"matches",r=[],n=0,a=t.length;n<a;n++)t[n][e](this.repeatableElement)&&r.push(t[n]);return result}},{key:"prepareTemplate",value:function(){var t=[].slice.call(this.children).filter(function(t){return t.classList.contains("subform-repeatable-template-section")});if(t[0]&&(this.template=t[0].innerHTML),!this.template)throw new Error("The row template are required to subform element to work")}},{key:"addRow",value:function(t){var e,r=this.getRows().length;if(r>=this.maximum)return null;(e="TBODY"===this.containerWithRows.nodeName||"TABLE"===this.containerWithRows.nodeName?document.createElement("tbody"):document.createElement("div")).innerHTML=this.template;var n=e.children[0];return t?t.parentNode.insertBefore(n,t.nextSibling):this.containerWithRows.append(n),this.buttonMove&&(n.setAttribute("draggable","false"),n.setAttribute("aria-grabbed","false"),n.setAttribute("tabindex","0")),n.setAttribute("data-new","1"),this.fixUniqueAttributes(n,r),this.dispatchEvent(new CustomEvent("subform-row-add",{detail:{row:n},bubbles:!0})),window.Joomla&&Joomla.Event.dispatch(n,"joomla:updated"),n}},{key:"removeRow",value:function(t){this.getRows().length<=this.minimum||(this.dispatchEvent(new CustomEvent("subform-row-remove",{detail:{row:t},bubbles:!0})),window.Joomla&&Joomla.Event.dispatch(t,"joomla:removed"),t.parentNode.removeChild(t))}},{key:"fixUniqueAttributes",value:function(t,r){var n=this;this.lastRowNum++,r=r||0;var a=t.getAttribute("data-group"),i=t.getAttribute("data-base-name"),o=Math.max(this.lastRowNum,r+1),u=i+o;this.lastRowNum=o,t.setAttribute("data-group",u);for(var l=t.querySelectorAll("[name]"),s={},b=0,f=(l=[].slice.call(l).filter(function(t){return e(t,"joomla-field-subform")===n})).length;b<f;b++){var m=l[b],d=m.getAttribute("name"),c=d.replace(/(\[\]$)/g,"").replace(/(\]\[)/g,"__").replace(/\[/g,"_").replace(/\]/g,""),g=d.replace("["+a+"][","["+u+"]["),h=c.replace(a,u),p=0,v=c;if("checkbox"===m.type&&d.match(/\[\]$/)){if(!(p=s[c]?s[c].length:0)){var A=e(m,"fieldset.checkboxes"),y=t.querySelector('label[for="'+c+'"]');A&&A.setAttribute("id",h),y&&(y.setAttribute("for",h),y.setAttribute("id",h+"-lbl"))}v+=p,h+=p}else if("radio"===m.type){if(!(p=s[c]?s[c].length:0)){var w=e(m,"fieldset.radio"),E=t.querySelector('label[for="'+c+'"]');w&&w.setAttribute("id",h),E&&(E.setAttribute("for",h),E.setAttribute("id",h+"-lbl"))}v+=p,h+=p}s[c]?s[c].push(!0):s[c]=[!0],m.name=g,m.id&&(m.id=h);var R=t.querySelector('label[for="'+v+'"]');R&&(R.setAttribute("for",h),R.setAttribute("id",h+"-lbl"))}}},{key:"setUpDragSort",value:function(){function t(t){return!t.form&&t[i](that.buttonMove)?t:e(t,that.buttonMove)}function n(t,e){var r=!1;if(t.parentNode===e.parentNode)for(var n=t;n;n=n.previousSibling)if(n===e){r=!0;break}r?e.parentNode.insertBefore(t,e):e.parentNode.insertBefore(t,e.nextSibling)}for(var a,o=this.getRows(),u=0,l=o.length;u<l;u++)(a=o[u]).setAttribute("draggable","false"),a.setAttribute("aria-grabbed","false"),a.setAttribute("tabindex","0");this.addEventListener("touchstart",function(r){touched=!0;var a=t(r.target),i=a?e(a,that.repeatableElement):null;i&&e(i,"joomla-field-subform")===that&&(item?(i!==item&&n(item,i),item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null):(i.setAttribute("draggable","true"),i.setAttribute("aria-grabbed","true"),item=i),r.preventDefault())}),this.addEventListener("mousedown",function(r){if(!touched){var n=t(r.target),a=n?e(n,that.repeatableElement):null;a&&e(a,"joomla-field-subform")===that&&(a.setAttribute("draggable","true"),a.setAttribute("aria-grabbed","true"),item=a)}}),this.addEventListener("mouseup",function(){item&&!touched&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null)}),this.addEventListener("keydown",function(t){if((t.keyCode===r.ESC||t.keyCode===r.SPACE||t.keyCode===r.ENTER)&&!t.target.form&&t.target[i](that.repeatableElement)){var a=t.target;if(a&&e(a,"joomla-field-subform")===that&&(t.keyCode===r.SPACE&&((o=t).ctrlKey||o.metaKey||o.shiftKey)&&("true"===a.getAttribute("aria-grabbed")?(a.setAttribute("draggable","false"),a.setAttribute("aria-grabbed","false"),item=null):(item&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null),a.setAttribute("draggable","true"),a.setAttribute("aria-grabbed","true"),item=a),t.preventDefault()),t.keyCode===r.ESC&&item&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null),t.keyCode===r.ENTER&&item)){if(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),a===item)return void(item=null);n(item,a),t.preventDefault(),item=null}}var o}),this.addEventListener("dragstart",function(t){item&&(t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text",""))}),this.addEventListener("dragover",function(t){item&&t.preventDefault()}),this.addEventListener("dragenter",function(t){if(item&&(!that.rowsContainer||e(t.target,that.rowsContainer)===that.containerWithRows)){var r=t.target[i](that.repeatableElement)?t.target:e(t.target,that.repeatableElement);r&&n(item,r)}}),this.addEventListener("dragend",function(){item&&(item.setAttribute("draggable","false"),item.setAttribute("aria-grabbed","false"),item=null)})}}]),o}();t.define("joomla-field-subform",o)}(customElements)},{}]},{},[1]);