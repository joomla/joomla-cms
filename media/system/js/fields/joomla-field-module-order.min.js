"use strict";customElements.define("joomla-field-module-order",class extends HTMLElement{constructor(){super(),this.linkedFieldSelector="",this.linkedFieldElement="",this.originalPosition="",this.writeDynaList.bind(this),this.getNewOrder.bind(this)}connectedCallback(){if(this.linkedFieldSelector=this.getAttribute("data-linked-field")||"jform_position",!this.linkedFieldSelector)throw new Error("No linked field defined!");if(this.linkedFieldElement=document.getElementById(this.linkedFieldSelector),!this.linkedFieldElement)throw new Error("No linked field defined!");const a=this;this.originalPosition=this.linkedFieldElement.value,this.getNewOrder(this.originalPosition),this.linkedFieldElement.addEventListener("change",()=>{a.originalPosition=a.linkedFieldElement.value,a.getNewOrder(a.linkedFieldElement.value)})}writeDynaList(a,b,c,d){let e=0;const f=document.createElement("select");for(const g in this.hasOwnProperty("disabled")&&f.setAttribute("disabled",""),this.getAttribute("onchange")&&f.setAttribute("onchange",this.getAttribute("onchange")),this.getAttribute("size")&&f.setAttribute("size",this.getAttribute("size")),f.classList.add(a.itemClass),f.setAttribute("name",a.name),f.id=a.id,b){if(!b.hasOwnProperty(g))continue;const a=document.createElement("option"),h=b[g];a.value=h[1],a.innerHTML=h[2],(c&&d===h[1]||!c&&0===e)&&a.setAttribute("selected","selected"),f.appendChild(a),e++}this.innerHTML="",this.appendChild(f)}getNewOrder(a){const b=this.getAttribute("data-url"),c=this.getAttribute("data-client-id"),d=this.getAttribute("data-ordering"),e=this.getAttribute("data-name"),f=this.getAttribute("data-client-attr")?this.getAttribute("data-client-attr"):"custom-select",g=`${this.getAttribute("data-id")}`,h=[],i=this;Joomla.request({url:`${b}&client_id=${c}&position=${a}`,method:"GET",perform:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},onSuccess(a){if(a&&(a=JSON.parse(a),0<a.data.length)){for(let b=0;b<a.data.length;++b)h[b]=a.data[b].split(",");i.writeDynaList({name:e,id:g,itemClass:f},h,i.originalPosition,d)}"object"==typeof a.messages&&null!==a.messages&&Joomla.renderMessages(a.messages)}})}});