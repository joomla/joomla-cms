!function(a){var b=function(b,c){this.select=a(b),this.options=a.extend({},a.fn.simplecolors.defaults,c),this.select.hide();var d="";a("option",this.select).each(function(){var b=a(this),c=b.val();if("-"==b.text())d+="<br />";else{var e="simplecolors-swatch";"none"==c&&(e+=" nocolor",c="transparent"),b.attr("selected")&&(e+=" active"),d+='<span class="'+e+'"><span style="background-color: '+c+';" tabindex="0"></span></span>'}});var e=this.select.val(),f="simplecolors-swatch";"none"==e&&(f+=" nocolor",e="transparent"),this.icon=a('<span class="'+f+'"><span style="background-color: '+e+';" tabindex="0"></span></span>').insertAfter(this.select),this.icon.on("click",a.proxy(this.show,this)),this.panel=a('<span class="simplecolors-panel"></span>').appendTo(document.body),this.panel.html(d),this.panel.on("click",a.proxy(this.click,this)),a(document).on("mousedown",a.proxy(this.hide,this)),this.panel.on("mousedown",a.proxy(this.mousedown,this))};b.prototype={constructor:b,show:function(){var a=7,b=this.icon.offset();switch(this.select.attr("data-position")){case"top":this.panel.css({left:b.left-a,top:b.top-this.panel.outerHeight()-1});break;case"bottom":this.panel.css({left:b.left-a,top:b.top+this.icon.outerHeight()});break;case"left":this.panel.css({left:b.left-this.panel.outerWidth(),top:b.top-(this.panel.outerHeight()-this.icon.outerHeight())/2-1});break;case"right":default:this.panel.css({left:b.left+this.icon.outerWidth(),top:b.top-(this.panel.outerHeight()-this.icon.outerHeight())/2-1})}this.panel.show(this.options.delay)},hide:function(){"none"!=this.panel.css("display")&&this.panel.hide(this.options.delay)},click:function(b){var c=a(b.target);if(1===c.length&&"span"===c[0].nodeName.toLowerCase()){var d="",e="",f="";c.parent().hasClass("nocolor")?(d="none",e="transparent",f="nocolor"):(d=this.rgb2hex(c.css("background-color")),e=d),c.parent().siblings().removeClass("active"),c.parent().addClass("active"),this.icon.removeClass("nocolor").addClass(f),this.icon.find("span").css("background-color",e),this.hide(),this.select.val(d).change()}},mousedown:function(a){a.stopPropagation(),a.preventDefault()},rgb2hex:function(a){function b(a){return("0"+parseInt(a,10).toString(16)).slice(-2)}var c=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return null===c?a:"#"+b(c[1])+b(c[2])+b(c[3])}},a.fn.simplecolors=function(c){return this.each(function(){var d=a(this),e=d.data("simplecolors"),f="object"==typeof c&&c;e||d.data("simplecolors",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.simplecolors.Constructor=b,a.fn.simplecolors.defaults={delay:0}}(jQuery);