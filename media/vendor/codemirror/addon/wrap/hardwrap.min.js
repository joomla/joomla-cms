!function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function r(t,r,e){for(var n=e.paragraphStart||t.getHelper(r,"paragraphStart"),o=r.line,a=t.firstLine();o>a;--o){s=t.getLine(o);if(n&&n.test(s))break;if(!/\S/.test(s)){++o;break}}for(var i=e.paragraphEnd||t.getHelper(r,"paragraphEnd"),f=r.line+1,l=t.lastLine();f<=l;++f){var s=t.getLine(f);if(i&&i.test(s)){++f;break}if(!/\S/.test(s))break}return{from:o,to:f}}function e(t,r,e,n){for(var o=r;o<t.length&&" "==t.charAt(o);)o++;for(;o>0&&!e.test(t.slice(o-1,o+1));--o);for(var a=!0;;a=!1){var i=o;if(n)for(;" "==t.charAt(i-1);)--i;if(0!=i||!a)return{from:i,to:o};o=r}}function n(r,n,a,i){n=r.clipPos(n),a=r.clipPos(a);var f=i.column||80,l=i.wrapOn||/\s\S|-[^\.\d]/,s=!1!==i.killTrailingSpace,h=[],c="",g=n.line,p=r.getRange(n,a,!1);if(!p.length)return null;for(var u=p[0].match(/^[ \t]*/)[0],m=0;m<p.length;++m){var v=p[m],d=c.length,x=0;c&&v&&!l.test(c.charAt(c.length-1)+v.charAt(0))&&(c+=" ",x=1);var b="";if(m&&(b=v.match(/^\s*/)[0],v=v.slice(b.length)),c+=v,m){var S=c.length>f&&u==b&&e(c,f,l,s);S&&S.from==d&&S.to==d+x?(c=u+v,++g):h.push({text:[x?" ":""],from:o(g,d),to:o(g+1,b.length)})}for(;c.length>f;){var E=e(c,f,l,s);h.push({text:["",u],from:o(g,E.from),to:o(g,E.to)}),c=u+c.slice(E.to),++g}}return h.length&&r.operation(function(){for(var e=0;e<h.length;++e){var n=h[e];(n.text||t.cmpPos(n.from,n.to))&&r.replaceRange(n.text,n.from,n.to)}}),h.length?{from:h[0].from,to:t.changeEnd(h[h.length-1])}:null}var o=t.Pos;t.defineExtension("wrapParagraph",function(t,e){e=e||{},t||(t=this.getCursor());var a=r(this,t,e);return n(this,o(a.from,0),o(a.to-1),e)}),t.commands.wrapLines=function(t){t.operation(function(){for(var e=t.listSelections(),a=t.lastLine()+1,i=e.length-1;i>=0;i--){var f,l=e[i];if(l.empty()){var s=r(t,l.head,{});f={from:o(s.from,0),to:o(s.to-1)}}else f={from:l.from(),to:l.to()};f.to.line>=a||(a=f.from.line,n(t,f.from,f.to,{}))}})},t.defineExtension("wrapRange",function(t,r,e){return n(this,t,r,e||{})}),t.defineExtension("wrapParagraphsInRange",function(t,e,a){a=a||{};for(var i=this,f=[],l=t.line;l<=e.line;){var s=r(i,o(l,0),a);f.push(s),l=s.to}var h=!1;return f.length&&i.operation(function(){for(var t=f.length-1;t>=0;--t)h=h||n(i,o(f[t].from,0),o(f[t].to-1),a)}),h})}),function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function r(t,r,e){for(var n=e.paragraphStart||t.getHelper(r,"paragraphStart"),o=r.line,a=t.firstLine();o>a&&(s=t.getLine(o),!n||!n.test(s));--o)if(!/\S/.test(s)){++o;break}for(var i=e.paragraphEnd||t.getHelper(r,"paragraphEnd"),f=r.line+1,l=t.lastLine();f<=l;++f){var s=t.getLine(f);if(i&&i.test(s)){++f;break}if(!/\S/.test(s))break}return{from:o,to:f}}function e(t,r,e,n){for(var o=r;o<t.length&&" "==t.charAt(o);)o++;for(;o>0&&!e.test(t.slice(o-1,o+1));--o);for(var a=!0;;a=!1){var i=o;if(n)for(;" "==t.charAt(i-1);)--i;if(0!=i||!a)return{from:i,to:o};o=r}}function n(r,n,a,i){n=r.clipPos(n),a=r.clipPos(a);var f=i.column||80,l=i.wrapOn||/\s\S|-[^\.\d]/,s=!1!==i.killTrailingSpace,h=[],c="",g=n.line,p=r.getRange(n,a,!1);if(!p.length)return null;for(var u=p[0].match(/^[ \t]*/)[0],m=0;m<p.length;++m){var v=p[m],d=c.length,x=0;c&&v&&!l.test(c.charAt(c.length-1)+v.charAt(0))&&(c+=" ",x=1);var b="";if(m&&(b=v.match(/^\s*/)[0],v=v.slice(b.length)),c+=v,m){var S=c.length>f&&u==b&&e(c,f,l,s);S&&S.from==d&&S.to==d+x?(c=u+v,++g):h.push({text:[x?" ":""],from:o(g,d),to:o(g+1,b.length)})}for(;c.length>f;){var E=e(c,f,l,s);h.push({text:["",u],from:o(g,E.from),to:o(g,E.to)}),c=u+c.slice(E.to),++g}}return h.length&&r.operation(function(){for(var e=0;e<h.length;++e){var n=h[e];(n.text||t.cmpPos(n.from,n.to))&&r.replaceRange(n.text,n.from,n.to)}}),h.length?{from:h[0].from,to:t.changeEnd(h[h.length-1])}:null}var o=t.Pos;t.defineExtension("wrapParagraph",function(t,e){e=e||{},t||(t=this.getCursor());var a=r(this,t,e);return n(this,o(a.from,0),o(a.to-1),e)}),t.commands.wrapLines=function(t){t.operation(function(){for(var e=t.listSelections(),a=t.lastLine()+1,i=e.length-1;i>=0;i--){var f,l=e[i];if(l.empty()){var s=r(t,l.head,{});f={from:o(s.from,0),to:o(s.to-1)}}else f={from:l.from(),to:l.to()};f.to.line>=a||(a=f.from.line,n(t,f.from,f.to,{}))}})},t.defineExtension("wrapRange",function(t,r,e){return n(this,t,r,e||{})}),t.defineExtension("wrapParagraphsInRange",function(t,e,a){a=a||{};for(var i=this,f=[],l=t.line;l<=e.line;){var s=r(i,o(l,0),a);f.push(s),l=s.to}var h=!1;return f.length&&i.operation(function(){for(var t=f.length-1;t>=0;--t)h=h||n(i,o(f[t].from,0),o(f[t].to-1),a)}),h})}),function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],t):t(CodeMirror)}(function(t){"use strict";function r(t,r,e){for(var n=e.paragraphStart||t.getHelper(r,"paragraphStart"),o=r.line,a=t.firstLine();o>a&&(s=t.getLine(o),!n||!n.test(s));--o)if(!/\S/.test(s)){++o;break}for(var i=e.paragraphEnd||t.getHelper(r,"paragraphEnd"),f=r.line+1,l=t.lastLine();f<=l;++f){var s=t.getLine(f);if(i&&i.test(s)){++f;break}if(!/\S/.test(s))break}return{from:o,to:f}}function e(t,r,e,n){for(var o=r;o<t.length&&" "==t.charAt(o);)o++;for(;o>0&&!e.test(t.slice(o-1,o+1));--o);for(var a=!0;;a=!1){var i=o;if(n)for(;" "==t.charAt(i-1);)--i;if(0!=i||!a)return{from:i,to:o};o=r}}function n(r,n,a,i){n=r.clipPos(n),a=r.clipPos(a);var f=i.column||80,l=i.wrapOn||/\s\S|-[^\.\d]/,s=!1!==i.killTrailingSpace,h=[],c="",g=n.line,p=r.getRange(n,a,!1);if(!p.length)return null;for(var u=p[0].match(/^[ \t]*/)[0],m=0;m<p.length;++m){var v=p[m],d=c.length,x=0;c&&v&&!l.test(c.charAt(c.length-1)+v.charAt(0))&&(c+=" ",x=1);var b="";if(m&&(b=v.match(/^\s*/)[0],v=v.slice(b.length)),c+=v,m){var S=c.length>f&&u==b&&e(c,f,l,s);S&&S.from==d&&S.to==d+x?(c=u+v,++g):h.push({text:[x?" ":""],from:o(g,d),to:o(g+1,b.length)})}for(;c.length>f;){var E=e(c,f,l,s);h.push({text:["",u],from:o(g,E.from),to:o(g,E.to)}),c=u+c.slice(E.to),++g}}return h.length&&r.operation(function(){for(var e=0;e<h.length;++e){var n=h[e];(n.text||t.cmpPos(n.from,n.to))&&r.replaceRange(n.text,n.from,n.to)}}),h.length?{from:h[0].from,to:t.changeEnd(h[h.length-1])}:null}var o=t.Pos;t.defineExtension("wrapParagraph",function(t,e){e=e||{},t||(t=this.getCursor());var a=r(this,t,e);return n(this,o(a.from,0),o(a.to-1),e)}),t.commands.wrapLines=function(t){t.operation(function(){for(var e=t.listSelections(),a=t.lastLine()+1,i=e.length-1;i>=0;i--){var f,l=e[i];if(l.empty()){var s=r(t,l.head,{});f={from:o(s.from,0),to:o(s.to-1)}}else f={from:l.from(),to:l.to()};f.to.line>=a||(a=f.from.line,n(t,f.from,f.to,{}))}})},t.defineExtension("wrapRange",function(t,r,e){return n(this,t,r,e||{})}),t.defineExtension("wrapParagraphsInRange",function(t,e,a){a=a||{};for(var i=this,f=[],l=t.line;l<=e.line;){var s=r(i,o(l,0),a);f.push(s),l=s.to}var h=!1;return f.length&&i.operation(function(){for(var t=f.length-1;t>=0;--t)h=h||n(i,o(f[t].from,0),o(f[t].to-1),a)}),h})});