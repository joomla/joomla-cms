var Aes={};Aes.Cipher=function(r,e){for(var o=e.length/4-1,n=[[],[],[],[]],a=0;a<16;a++)n[a%4][Math.floor(a/4)]=r[a];n=Aes.AddRoundKey(n,e,0,4);for(var t=1;t<o;t++)n=Aes.SubBytes(n,4),n=Aes.ShiftRows(n,4),n=Aes.MixColumns(n,4),n=Aes.AddRoundKey(n,e,t,4);n=Aes.SubBytes(n,4),n=Aes.ShiftRows(n,4),n=Aes.AddRoundKey(n,e,o,4);for(var f=new Array(16),a=0;a<16;a++)f[a]=n[a%4][Math.floor(a/4)];return f},Aes.KeyExpansion=function(r){for(var e=r.length/4,o=e+6,n=new Array(4*(o+1)),a=new Array(4),t=0;t<e;t++){var f=[r[4*t],r[4*t+1],r[4*t+2],r[4*t+3]];n[t]=f}for(t=e;t<4*(o+1);t++){n[t]=new Array(4);for(c=0;c<4;c++)a[c]=n[t-1][c];if(t%e==0){a=Aes.SubWord(Aes.RotWord(a));for(c=0;c<4;c++)a[c]^=Aes.Rcon[t/e][c]}else e>6&&t%e==4&&(a=Aes.SubWord(a));for(var c=0;c<4;c++)n[t][c]=n[t-e][c]^a[c]}return n},Aes.SubBytes=function(r,e){for(var o=0;o<4;o++)for(var n=0;n<e;n++)r[o][n]=Aes.Sbox[r[o][n]];return r},Aes.ShiftRows=function(r,e){for(var o=new Array(4),n=1;n<4;n++){for(a=0;a<4;a++)o[a]=r[n][(a+n)%e];for(var a=0;a<4;a++)r[n][a]=o[a]}return r},Aes.MixColumns=function(r,e){for(var o=0;o<4;o++){for(var n=new Array(4),a=new Array(4),t=0;t<4;t++)n[t]=r[t][o],a[t]=128&r[t][o]?r[t][o]<<1^283:r[t][o]<<1;r[0][o]=a[0]^n[1]^a[1]^n[2]^n[3],r[1][o]=n[0]^a[1]^n[2]^a[2]^n[3],r[2][o]=n[0]^n[1]^a[2]^n[3]^a[3],r[3][o]=n[0]^a[0]^n[1]^n[2]^a[3]}return r},Aes.AddRoundKey=function(r,e,o,n){for(var a=0;a<4;a++)for(var t=0;t<n;t++)r[a][t]^=e[4*o+t][a];return r},Aes.SubWord=function(r){for(var e=0;e<4;e++)r[e]=Aes.Sbox[r[e]];return r},Aes.RotWord=function(r){for(var e=r[0],o=0;o<3;o++)r[o]=r[o+1];return r[3]=e,r},Aes.Sbox=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],Aes.Rcon=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];var AesCtr={};AesCtr.encrypt=function(r,e,o){if(128!=o&&192!=o&&256!=o)return"";r=Utf8.encode(r),e=Utf8.encode(e);for(var n=o/8,a=new Array(n),t=0;t<n;t++)a[t]=isNaN(e.charCodeAt(t))?0:e.charCodeAt(t);var f=Aes.Cipher(a,Aes.KeyExpansion(a));f=f.concat(f.slice(0,n-16));for(var c=new Array(16),A=(new Date).getTime(),d=Math.floor(A/1e3),i=A%1e3,t=0;t<4;t++)c[t]=d>>>8*t&255;for(t=0;t<4;t++)c[t+4]=255&i;for(var s="",t=0;t<8;t++)s+=String.fromCharCode(c[t]);for(var u=Aes.KeyExpansion(f),h=Math.ceil(r.length/16),v=new Array(h),C=0;C<h;C++){for(l=0;l<4;l++)c[15-l]=C>>>8*l&255;for(var l=0;l<4;l++)c[15-l-4]=C/4294967296>>>8*l;for(var y=Aes.Cipher(c,u),g=C<h-1?16:(r.length-1)%16+1,S=new Array(g),t=0;t<g;t++)S[t]=y[t]^r.charCodeAt(16*C+t),S[t]=String.fromCharCode(S[t]);v[C]=S.join("")}var w=s+v.join("");return w=Base64.encode(w)},AesCtr.decrypt=function(r,e,o){if(128!=o&&192!=o&&256!=o)return"";r=Base64.decode(r),e=Utf8.encode(e);for(var n=o/8,a=new Array(n),t=0;t<n;t++)a[t]=isNaN(e.charCodeAt(t))?0:e.charCodeAt(t);var f=Aes.Cipher(a,Aes.KeyExpansion(a));f=f.concat(f.slice(0,n-16));var c=new Array(8);ctrTxt=r.slice(0,8);for(t=0;t<8;t++)c[t]=ctrTxt.charCodeAt(t);for(var A=Aes.KeyExpansion(f),d=Math.ceil((r.length-8)/16),i=new Array(d),s=0;s<d;s++)i[s]=r.slice(8+16*s,8+16*s+16);r=i;for(var u=new Array(r.length),s=0;s<d;s++){for(h=0;h<4;h++)c[15-h]=s>>>8*h&255;for(var h=0;h<4;h++)c[15-h-4]=(s+1)/4294967296-1>>>8*h&255;for(var v=Aes.Cipher(c,A),C=new Array(r[s].length),t=0;t<r[s].length;t++)C[t]=v[t]^r[s].charCodeAt(t),C[t]=String.fromCharCode(C[t]);u[s]=C.join("")}var l=u.join("");return l=Utf8.decode(l)};var Base64={};Base64.code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Base64.encode=function(r,e){e=void 0!==e&&e;var o,n,a,t,f,c,A,d,i=[],s="",u=Base64.code;if(A=e?r.encodeUTF8():r,(c=A.length%3)>0)for(;c++<3;)s+="=",A+="\0";for(c=0;c<A.length;c+=3)n=(o=A.charCodeAt(c)<<16|A.charCodeAt(c+1)<<8|A.charCodeAt(c+2))>>18&63,a=o>>12&63,t=o>>6&63,f=63&o,i[c/3]=u.charAt(n)+u.charAt(a)+u.charAt(t)+u.charAt(f);return d=i.join(""),d=d.slice(0,d.length-s.length)+s},Base64.decode=function(r,e){e=void 0!==e&&e;var o,n,a,t,f,c,A,d,i=[],s=Base64.code;d=e?r.decodeUTF8():r;for(var u=0;u<d.length;u+=4)o=(c=s.indexOf(d.charAt(u))<<18|s.indexOf(d.charAt(u+1))<<12|(t=s.indexOf(d.charAt(u+2)))<<6|(f=s.indexOf(d.charAt(u+3))))>>>16&255,n=c>>>8&255,a=255&c,i[u/4]=String.fromCharCode(o,n,a),64==f&&(i[u/4]=String.fromCharCode(o,n)),64==t&&(i[u/4]=String.fromCharCode(o));return A=i.join(""),e?A.decodeUTF8():A};var Utf8={};Utf8.encode=function(r){var e=r.replace(/[\u0080-\u07ff]/g,function(r){var e=r.charCodeAt(0);return String.fromCharCode(192|e>>6,128|63&e)});return e=e.replace(/[\u0800-\uffff]/g,function(r){var e=r.charCodeAt(0);return String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e)})},Utf8.decode=function(r){var e=r.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(r){var e=(31&r.charCodeAt(0))<<6|63&r.charCodeAt(1);return String.fromCharCode(e)});return e=e.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(r){var e=(15&r.charCodeAt(0))<<12|(63&r.charCodeAt(1))<<6|63&r.charCodeAt(2);return String.fromCharCode(e)})};