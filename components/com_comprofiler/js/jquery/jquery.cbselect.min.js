!function(e){function t(e){e.element.children().length?(e.dropdown.removeClass("select2-container--empty"),e.container.removeClass("select2-container--empty")):(e.dropdown.addClass("select2-container--empty"),e.container.addClass("select2-container--empty"))}function n(t){var n=t.container.offset().top+t.container.outerHeight(!1)+t.dropdown.outerHeight(!1)<=e(window).scrollTop()+e(window).height(),s=t.container.offset().top-t.dropdown.outerHeight(!1)>=e(window).scrollTop(),l=null;l=t.dropdown.is(".top")?!(!s&&n):!n&&s,l?t.dropdown.css({top:t.container.offset().top-t.dropdown.outerHeight(!1),left:t.container.offset().left,bottom:"auto"}).removeClass("bottom").addClass("top"):t.dropdown.css({top:t.container.offset().top+t.container.outerHeight(!1),left:t.container.offset().left,bottom:"auto"}).removeClass("top").addClass("bottom")}var s=[],l={init:function(l){return this.each(function(){var i=this,o=e(i).data("cbselect");if(!o){if(o={},o.type=!e(i).prop("multiple")&&"multipleselect"!=e(this).data("cbselect-type")||"undefined"!=typeof e(this).data("cbselect-tags")?"select2":"multipleselect",o.options="undefined"!=typeof l?l:{},o.defaults=e.extend(!0,{},e.fn.cbselect.defaults,"multipleselect"==o.type?e.fn.cbselect.defaults.multipleselect:e.fn.cbselect.defaults.select2),o.settings=e.extend(!0,{},o.defaults,o.options),o.element=e(i),o.settings.useData){var a=e.extend(!0,{},"multipleselect"==o.type?e.fn.multipleSelect.defaults:e.fn.select2.defaults,o.defaults);e.each(a,function(e){if("init"!=e&&"useData"!=e){var t=o.element.data("cbselect"+e.charAt(0).toUpperCase()+e.slice(1));"undefined"!=typeof t?o.settings[e]=t:(t=o.element.data("cbselect"+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),"undefined"!=typeof t&&(o.settings[e]=t))}})}if(o.element.triggerHandler("cbselect.init.before",[o]),o.settings.init){var c=o.element.data("cbselect-tags");if("undefined"!=typeof c){o.type="select2";var r=o.element.data("cbselect-tags-separators");"undefined"==typeof r&&(r=[","]),"calculate"==o.settings.width&&(o.settings.width="auto"),"calculate"==o.settings.height&&(o.settings.height="auto"),o.settings.tags=!0,o.settings.tokenSeparators=r}var d=null,p=null;if("calculate"==o.settings.width||"calculate"==o.settings.height){if(d=o.element.outerWidth()+50,p=o.element.outerHeight(),o.element.is(":hidden")){var m=o.element.css("width"),u=o.element.css("height"),h=o.element.clone(!1).attr({id:"","class":""}).css({position:"absolute",display:"block",visibility:"hidden",width:"auto",height:"auto",minWidth:m&&"0px"!=m?m:"auto",minHeight:u&&"0px"!=u?u:"auto",padding:o.element.css("padding"),border:o.element.css("border"),margin:o.element.css("margin"),fontFamily:o.element.css("font-family"),fontSize:o.element.css("font-size"),fontWeight:o.element.css("font-weight"),lineHeight:o.element.css("line-height"),boxSizing:o.element.css("box-sizing"),wordSpacing:o.element.css("word-spacing")}).appendTo("body");d=h.outerWidth()+50,p=h.outerHeight(),h.remove()}"calculate"==o.settings.width&&(o.settings.width=d),"calculate"==o.settings.height&&(o.settings.height=p)}"element"==o.settings.width?(d=o.element.outerWidth(),d&&"0px"!=d||(d="auto")):"copy"==o.settings.width||"resolve"==o.settings.width?(d=o.element.css("width"),d&&"0px"!=d||(d="auto")):"off"==o.settings.width?d=null:d||(d=o.settings.width),"element"==o.settings.height?(p=o.element.outerHeight(),p&&"0px"!=p||(p="auto")):"copy"==o.settings.height||"resolve"==o.settings.height?(p=o.element.css("height"),p&&"0px"!=p||(p="auto")):"off"==o.settings.height?p=null:p||(p=o.settings.height);var g=o.element.hasClass("cbTooltip")||"undefined"!=typeof o.element.data("hascbtooltip");if(g&&(o.element.attr("data-cbtooltip-open-target","#cbselect_"+o.element.attr("id")),o.element.attr("data-cbtooltip-close-target","#cbselect_"+o.element.attr("id")),o.element.attr("data-cbtooltip-position-target","#cbselect_"+o.element.attr("id")),o.element.data("cbtooltip-open-target","#cbselect_"+o.element.attr("id")),o.element.data("cbtooltip-close-target","#cbselect_"+o.element.attr("id")),o.element.data("cbtooltip-position-target","#cbselect_"+o.element.attr("id"))),"multipleselect"==o.type){o.settings.onOpen=function(){o.container.addClass("ms-parent-active"),o.dropdown.find(".ms-search > input").blur(),n(o),o.dropdown.find(".ms-search > input").focus(),o.element.triggerHandler("cbselect.open",[o])},o.settings.onClose=function(){o.container.removeClass("ms-parent-active"),o.element.triggerHandler("cbselect.close",[o])},o.settings.onClick=function(e){e.checked?o.element.triggerHandler("cbselect.selecting",[o,e.value,e]):o.element.triggerHandler("cbselect.removing",[o,e.value,e])},o.settings.onOptgroupClick=function(t){e.each(t.children,function(n,s){t.checked?o.element.triggerHandler("cbselect.selecting",[o,e(s).val(),s]):o.element.triggerHandler("cbselect.removing",[o,e(s).val(),s])})},o.element.multipleSelect(o.settings),o.container=o.element.siblings(".ms-parent"),o.dropdown=o.container.find(".ms-drop");var f=o.dropdown.outerWidth(!1);o.dropdown.css("width","auto"==d?"auto":f>d?f:d).appendTo("body"),n(o),o.container.removeClass("cbTooltip cbSelect"),e(window).on("resize scroll",function(){o.container.is(".ms-parent-active")&&n(o)}),o.dropdown.find(".ms-search > input").on("keyup",function(){n(o)})}else{var b=[];e.each(o.element.attr("class").split(/\s+/),function(e,t){"cbTooltip"!=t&&"cbSelect"!=t&&b.push(t)});var v=e.extend(!0,{},o.settings);delete v.containerCssClass,delete v.dropdownCssClass,o.element.select2(v);var w=o.element.data("select2");o.container=w.$container,o.dropdown=w.$dropdown,e.each(b,function(e,t){o.container.addClass(t)}),o.element.prop("multiple")?(o.dropdown.addClass("select2-container--multiple"),o.container.addClass("select2-container--multiple")):(o.dropdown.addClass("select2-container--single"),o.container.addClass("select2-container--single")),o.settings.tags&&(o.dropdown.addClass("select2-container--tags"),o.container.addClass("select2-container--tags")),t(o),o.container.on("keyup",".select2-search__field",function(){t(o)}),o.element.on("select2:open",function(){t(o),o.element.triggerHandler("cbselect.open",[o])}).on("select2:close",function(){t(o),o.element.triggerHandler("cbselect.close",[o])}).on("select2:select",function(e){t(o),o.element.triggerHandler("cbselect.selecting",[o,e.params.data.id,e.params.data.element])}).on("select2:unselect",function(e){t(o),o.element.triggerHandler("cbselect.removing",[o,e.params.data.id,e.params.data.element])})}o.container.attr("id","cbselect_"+o.element.attr("id")),p&&"0px"!=p&&o.container.css("height",p),o.settings.containerCssClass&&o.container.addClass(o.settings.containerCssClass),o.settings.dropdownCssClass&&o.dropdown.addClass(o.settings.dropdownCssClass),o.element.on("change",function(){"undefined"!=typeof cbParamChange&&cbParamChange.call(i)}),o.element.on("rebind.cbselect",function(){o.element.cbselect("rebind")}),o.element.on("modified.cbselect",function(e,t,n){t!=n&&o.element.cbselect("rebind")}),o.element.on("cloned.cbselect",function(){e(this).off("rebind.cbselect"),e(this).off("cloned.cbselect"),e(this).off("modified.cbselect"),e(this).removeData("cbselect"),g&&(e(this).removeAttr("data-cbtooltip-open-target"),e(this).removeAttr("data-cbtooltip-close-target"),e(this).removeAttr("data-cbtooltip-position-target"),e(this).removeData("cbtooltip-open-target"),e(this).removeData("cbtooltip-close-target"),e(this).removeData("cbtooltip-position-target")),"multipleselect"==o.type?(e(this).removeData("multipleSelect"),e(this).siblings(".ms-parent").remove()):(e(this).select2("close"),e(this).removeData("select2"),e(this).off(".select2"),e(this).removeClass("select2-hidden-accessible"),e(this).siblings(".select2-container").remove(),e(this).removeAttr("tabindex"),e(this).removeData("old-tabindex")),e(this).show(),e(this).cbselect(o.options)}),o.element.triggerHandler("cbselect.init.after",[o]),o.element.data("cbselect",o),s.push(o)}}})},get:function(){var t=e(this).data("cbselect");return t?"multipleselect"==t.type?t.element.multipleSelect("getSelects"):t.element.val():null},set:function(t){var n=e(this).data("cbselect");return n?("multipleselect"==n.type?(e.isArray(t)||(t=[t]),n.element.multipleSelect("setSelects",t)):n.element.val(t).trigger("change"),l.get.call(this)):null},unset:function(t){var n=e(this).data("cbselect");if(!n)return null;e.isArray(t)||(t=[t]);var s=l.get.call(this),i=s;return e.isArray(s)?e.each(t,function(e,t){i.indexOf(t)>-1&&i.splice(i.indexOf(t),1)}):e.each(t,function(e,t){return t===s?(i="",!1):void 0}),l.set.call(this,i)},enable:function(){var t=e(this).data("cbselect");return t?("multipleselect"==t.type?t.element.multipleSelect("enable"):t.element.prop("disabled",!1),this):this},disable:function(){var t=e(this).data("cbselect");return t?("multipleselect"==t.type?t.element.multipleSelect("disable"):t.element.prop("disabled",!0),this):this},container:function(){var t=e(this).data("cbselect");return t?t.container:this},dropdown:function(){var t=e(this).data("cbselect");return t?t.dropdown:this},rebind:function(){var t=e(this).data("cbselect");return t?(t.element.cbselect("destroy"),t.element.cbselect(t.options),this):this},destroy:function(){var t=e(this).data("cbselect");return t?((t.element.hasClass("cbTooltip")||"true"==t.element.data("hascbtooltip"))&&(t.element.removeAttr("data-cbtooltip-open-target"),t.element.removeAttr("data-cbtooltip-close-target"),t.element.removeAttr("data-cbtooltip-position-target")),"multipleselect"==t.type?(t.element.removeData("multipleSelect"),t.dropdown.remove(),t.container.remove(),t.element.show()):t.element.select2("destroy"),t.element.off("rebind.cbselect"),t.element.off("cloned.cbselect"),t.element.off("modified.cbselect"),e.each(s,function(e,n){return n.element==t.element?(s.splice(e,1),!1):!0}),t.element.removeData("cbselect"),t.element.triggerHandler("cbselect.destroyed",[t]),this):this},instances:function(){return s}};e.fn.cbselect=function(e){return l[e]?l[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?this:l.init.apply(this,arguments)},e.fn.cbselect.defaults={init:!0,useData:!0,width:"calculate",height:"off",placeholder:null,dropdownCssClass:null,containerCssClass:null},e.fn.cbselect.defaults.select2={dropdownAutoWidth:!0,theme:"bootstrap"},e.fn.cbselect.defaults.multipleselect={filter:!0,minimumCountSelected:1}}(jQuery);