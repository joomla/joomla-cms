!function(e){function t(e,t){return"TB"==t?e=e/1024/1024/1024/1024:"GB"==t?e=e/1024/1024/1024:"MB"==t?e=e/1024/1024:"KB"==t&&(e/=1024),e}var a=[],i={init:function(t){return this.each(function(){var i=this,s=e(i).data("cbvalidate");s||(s={},s.options="undefined"!=typeof t?t:{},s.defaults=e.fn.cbvalidate.defaults,s.settings=e.extend(!0,{},s.defaults,s.options),s.element=e(i),s.settings.useData&&e.each(s.defaults,function(e){if("init"!=e&&"useData"!=e){var t=s.element.data("cbvalidate"+e.charAt(0).toUpperCase()+e.slice(1));"undefined"!=typeof t?s.settings[e]=t:(t=s.element.data("cbvalidate"+e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()),"undefined"!=typeof t&&(s.settings[e]=t))}}),s.element.triggerHandler("cbvalidate.init.before",[s]),s.settings.init&&(s.settings.messages&&e.extend(e.validator.messages,s.settings.messages),s.element.on("submit",function(t){var a=e(this).find('button[type="submit"][data-submit-text],input[type="submit"][data-submit-text]');a.each(function(){var t=e(this).data("submit-text"),a=null;e(this).prop("disabled",!0),e(this).is("input")?(a=e(this).val(),e(this).val(t)):(a=e(this).html(),e(this).html(t)),e(this).data("button-text",a)});var i=e(this).validate();i.cbIsFormSubmitting=!0;var n=i.form();if(i.cbIsFormSubmitting=!1,!n){a.each(function(){var t=e(this).data("button-text");e(this).prop("disabled",!1),e(this).is("input")?e(this).val(t):e(this).html(t),e(this).removeData("button-text")});var r=s.validate.errorList;if(r.length){var l=e(r[0].element),d=l.closest(".cbTabPane");if(d.length){var o=d.closest(".cbTabs");if(o.length){var u=o.data("cbtabs");u&&u.element.cbtabs("select",d.attr("id"))}}e.scrollTo(l,0,{axis:"y",offset:{top:-((e(window).outerHeight()-l.outerHeight())/2),left:0}})}i.focusInvalid(),t.preventDefault()}s.element.triggerHandler("cbvalidate.validate",[s,n])}),s.validate=s.element.validate({onsubmit:!1,ignoreTitle:!0,errorClass:"cbValidationMessage",validClass:"cbValidationMessage",ignore:'.cbValidationDisabled,.hidden,.disabled,.ignore,:disabled,[readonly],[type="hidden"]',cbIsFormSubmitting:!1,cbIsOnFocusOut:!1,cbIsOnKeyUp:!1,cbIsOnClick:!1,cbIsOnChange:!1,success:function(t,a){var i=s.validate.errorsFor(a);i.length>1&&i.not(t).remove();var n=e(a).data("remote-response");n||(n=e(a).data("msg-success")),n?(t.find(".cbValidationIcon").remove(),t.removeClass("text-danger"),t.html(n),"<"!=n.toString().charAt(0)&&(t.prepend('<span class="cbValidationIcon fa fa-check"></span>'),t.addClass("text-success"))):t.remove(),s.element.triggerHandler("cbvalidate.success",[s,t,a])},showErrors:function(t,a){var i=this;i.defaultShowErrors(),e.each(a,function(e,t){var a=i.errorsFor(t.element);a.length>1&&a.not(":last").remove(),a.find(".cbValidationIcon").remove(),a.removeClass("text-success"),"<"!=t.message.toString().charAt(0)&&(a.prepend('<span class="cbValidationIcon fa fa-times"></span>'),a.addClass("text-danger"))}),s.element.triggerHandler("cbvalidate.showerrors",[s,t,a])},highlight:function(t,a,i){e(t).addClass("cbValidationError"),e(t).closest(".cb_form_line").addClass("cbValidationError has-error"),e(t).closest("tr").addClass("cbValidationError has-error");var n=s.element.find(".cbTabs");n.length&&n.each(function(){var t=e(this).data("cbtabs");t&&e.each(t.tabs,function(e,t){var a=t.tabPane.find("input.cbValidationError,select.cbValidationError,textarea.cbValidationError").not(":submit,:reset,:image,[disabled],[readonly]").not(s.validate.settings.ignore);a.length&&t.tabNav.addClass("cbValidationError has-error")})}),s.element.triggerHandler("cbvalidate.highlight",[s,t,a,i])},unhighlight:function(t,a,i){e(t).removeClass("cbValidationError"),e(t).closest(".cb_form_line").removeClass("cbValidationError has-error"),e(t).closest("tr").removeClass("cbValidationError has-error");var n=s.element.find(".cbTabs");n.length&&n.each(function(){var t=e(this).data("cbtabs");t&&e.each(t.tabs,function(e,t){var a=t.tabPane.find("input.cbValidationError,select.cbValidationError,textarea.cbValidationError").not(":submit,:reset,:image,[disabled],[readonly]").not(s.validate.settings.ignore);a.length||t.tabNav.removeClass("cbValidationError has-error")})}),s.element.triggerHandler("cbvalidate.unhighlight",[s,t,a,i])},errorElement:"div",errorPlacement:function(e,t){var a=t.closest(".fieldCell,.cbFieldSpan,.cb_field");a.length?e.appendTo(a):e.insertAfter(t),s.element.triggerHandler("cbvalidate.errorplacement",[s,e,t])},onfocusout:function(e){this.cbIsOnFocusOut=!0,this.element(e),this.cbIsOnFocusOut=!1,s.element.triggerHandler("cbvalidate.focusout",[s,e])},onkeyup:function(e){this.cbIsOnKeyUp=!0,this.element(e),this.cbIsOnKeyUp=!1,s.element.triggerHandler("cbvalidate.keyup",[s,e])},onclick:function(e){this.cbIsOnClick=!0,this.element(e),this.cbIsOnClick=!1,s.element.triggerHandler("cbvalidate.click",[s,e])},onchange:function(e){this.cbIsOnChange=!0,this.element(e),this.cbIsOnChange=!1,s.element.triggerHandler("cbvalidate.change",[s,e])}}),s.element.validateDelegate("input,select,textarea","change",function(t){var a=e.data(this[0].form,"validator"),i="on"+t.type.replace(/^validate/,""),s=a.settings;s[i]&&!this.is(s.ignore)&&s[i].call(a,this[0],t)}),s.validate.options=s.settings,s.element.triggerHandler("cbvalidate.init.after",[s]),s.element.data("cbvalidate",s),a.push(s)))})},validate:function(t,a){var i=e(this).data("cbvalidate");if(!i)return!0;"undefined"==typeof t&&(t=null),"undefined"==typeof a&&(a=!1),i.validate.cbIsFormSubmitting=!0;var s=!0;if(t)if(a){var n=i.validate.currentForm;i.validate.currentForm=t;var r=i.validate.elements();i.validate.currentForm=n;var l=0;r.each(function(){var t=this;e.each(n,function(e,a){a==t&&(i.validate.element(a)||l++)})}),s=l?!1:!0}else s=i.validate.element(t);else s=i.validate.form();return i.validate.cbIsFormSubmitting=!1,s||i.validate.focusInvalid(),i.element.triggerHandler("cbvalidate.validate",[i,s]),s},reset:function(){var t=e(this).data("cbvalidate");return t?(t.validate.resetForm(),t.element.triggerHandler("cbvalidate.reset",[t]),!0):!1},invalid:function(){var t=e(this).data("cbvalidate");if(!t)return 0;var a=t.validate.numberOfInvalids();return t.element.triggerHandler("cbvalidate.invalid",[t,a]),a},focus:function(){var t=e(this).data("cbvalidate");return t?(t.validate.focusInvalid(),t.element.triggerHandler("cbvalidate.focus",[t]),!0):!1},valid:function(){var t=e(this).data("cbvalidate");if(!t)return!0;var a=t.validate.valid();return t.element.triggerHandler("cbvalidate.valid",[t,a]),a},elements:function(t){var a=e(this).data("cbvalidate");if(!a)return[];"undefined"==typeof t&&(t=null);var i=[];return i="invalid"==t?a.validate.invalidElements():"valid"==t?a.validate.validElements():a.validate.elements(),a.element.triggerHandler("cbvalidate.elements",[a,i]),i},errors:function(){var t=e(this).data("cbvalidate");if(!t)return[];var a=t.validate.errors();return t.element.triggerHandler("cbvalidate.errors",[t,a]),a},instances:function(){return a}};e.validator.addMethod("cbfield",function(t,a,i){var s=this.options;return i.method||(i.method="cbfield"),i["function"]||(i["function"]="checkvalue"),i.data={user:i.user,field:i.field,reason:i.reason,value:t},s.settings.cbfield.url&&(i.url=s.settings.cbfield.url),s.settings.cbfield.spooffield&&s.settings.cbfield.spooffield&&(i.data[s.settings.cbfield.spooffield]=s.settings.cbfield.spoofstring),s.settings.cbfield.spamfield&&s.settings.cbfield.spamstring&&(i.data[s.settings.cbfield.spamfield]=s.settings.cbfield.spamstring),e.validator.methods.cbremote.call(this,t,a,i)},"Please fix this field."),e.validator.addMethod("cbremote",function(t,a,i){if(e(a).data("remote-response",null),this.optional(a)||this.cbIsOnChange||this.cbIsFormSubmitting||!i.url)return!0;e.each(i,function(e,t){"object"!=typeof t&&"array"!=typeof t&&"url"!=e&&"data"!=e&&(i.url=i.url.replace("["+e+"]",t))});var s=this.previousValue(a),n=this;return this.settings.messages[a.name]||(this.settings.messages[a.name]={}),i.method||(i.method="cbremote"),s.originalMessage=this.settings.messages[a.name][i.method],this.settings.messages[a.name][i.method]=s.message,s.old===t?(e(a).data("remote-response",e(s).data("remote-response")),s.valid):this.cbIsOnKeyUp?!0:(s.old=t,e(s).data("remote-response",null),this.startRequest(a),e.ajax({url:i.url,type:"POST",mode:"abort",port:"validate"+a.name,dataType:"json",data:i.data,converters:{"text json":function(t){try{return e.parseJSON(t)}catch(a){return{valid:!0,message:t}}}},beforeSend:function(){e('<span class="cbSpinner fa fa-spinner fa-spin-fast fa-infix"></span>').insertAfter(e(a))}}).done(function(r){var l=r.valid===!0||"true"===r.valid,d={},o=null,u=null;n.settings.messages[a.name][i.method]=s.originalMessage,l?(e(a).data("remote-response",r.message),e(s).data("remote-response",r.message),u=n.formSubmitted,n.prepareElement(a),n.formSubmitted=u,n.successList.push(a),delete n.invalid[a.name],n.showErrors()):(o=r.message||n.defaultMessage(a,i.method),d[a.name]=s.message=e.isFunction(o)?o(t):o,n.invalid[a.name]=!0,n.showErrors(d)),s.valid=l,n.stopRequest(a,l)}).always(function(){e(a).siblings(".cbSpinner").remove()}),"pending")},"Please fix this field."),e.validator.addMethod("accept",function(t,a,i){var s="string"==typeof i?i.replace(/\s/g,"").replace(/,/g,"|"):"image/*",n=this.optional(a);if(n)return n;if("file"===e(a).attr("type")&&(s=s.replace(/\*/g,".*"),a.files&&a.files.length))for(var r=0;r<a.files.length;r++){var l=a.files[r];if(l.type&&!l.type.replace(/mp3/,"mpeg").replace(/m4a/,"mp4").match(new RegExp(".?("+s+")$","i")))return!1}return!0},e.validator.format("Please enter a value with a valid extension.")),e.validator.addMethod("extension",function(e,t,a){return a="string"==typeof a?a.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(t)||e.match(new RegExp(".("+a+")$","i"))},e.validator.format("Please enter a value with a valid extension.")),e.validator.addMethod("maxWords",function(t,a,i){return this.optional(a)||e(t).text().match(/\b\w+\b/g).length<=i},e.validator.format("Please enter {0} words or less.")),e.validator.addMethod("minWords",function(t,a,i){return this.optional(a)||e(t).text().match(/\b\w+\b/g).length>=i},e.validator.format("Please enter at least {0} words.")),e.validator.addMethod("rangeWords",function(t,a,i){var s=e(t).text(),n=/\b\w+\b/g;return this.optional(a)||s.match(n).length>=i[0]&&s.match(n).length<=i[1]},e.validator.format("Please enter between {0} and {1} words.")),e.validator.addMethod("pattern",function(e,t,a){if(this.optional(t))return!0;if("string"==typeof a){var i=a.substr(0,1),s=a.lastIndexOf(i),n=a.slice(1,s),r=a.substr(s+1);n=n.replace(i+i,i),a=new RegExp(n,r)}return a.test(e)},"Invalid format."),e.validator.addMethod("cburl",function(e,t){return this.optional(t)||/^(?:(https?|ftp):\/\/)?(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},"Please enter a valid URL."),e.validator.addMethod("cbusername",function(e,t){return this.optional(t)||!/^\s+|[<>"'%;()&\\]|\.\.\/|\s+$/i.test(e)},"Please enter a valid username with no space at beginning or end and must not contain the following characters: < > \\ \" ' % ; ( ) &"),e.validator.addMethod("passwordstrength",function(t,a){var i=[/.{8,}/,/[A-Z]+/,/[a-z]+/,/\d+/,/[\-\]\\`~!@#$%^&*()_=+[{}|;:'",<.>\/?]+/,/.{12,}/,/[A-Z]{2,}/,/[a-z]{2,}/,/\d{2,}/,/[\-\]\\`~!@#$%^&*()_=+[{}|;:'",<.>\/?]{2,}/],s=0;e.each(i,function(e,a){t.match(a)&&s++}),s>i.length?s=i.length:0>s&&(s=0);var n=s*(100/i.length),r="cbPasswordStrengthStrong progress-bar-success";30>=n?r="cbPasswordStrengthVeryWeak progress-bar-danger":50>=n?r="cbPasswordStrengthWeak progress-bar-warning":70>=n&&(r="cbPasswordStrengthOk progress-bar-info");var l=e(a).outerWidth();if(e(a).is(":hidden")){var d=e(a).clone(!1).attr({id:"","class":""}).css({position:"absolute",display:"block",width:"auto",visibility:"hidden",padding:e(a).css("padding"),border:e(a).css("border"),margin:e(a).css("margin"),fontFamily:e(a).css("font-family"),fontSize:e(a).css("font-size"),fontWeight:e(a).css("font-weight"),boxSizing:e(a).css("box-sizing")}).appendTo("body");l=d.outerWidth(),d.remove()}return e(a).data("msg-success",'<div class="cbPasswordStrength progress" style="width: '+l+'px"><div class="cbPasswordStrengthBar progress-bar '+r+'" style="width: '+n+'%"></div></div>'),!0},""),e.validator.addMethod("filesize",function(a,i,s){var n=this.optional(i);if(n)return n;var r=!1,l=!1;if((s[0]||s[1])&&"file"===e(i).attr("type")&&i.files&&i.files.length)for(var d=0;d<i.files.length;d++){var o=i.files[d],u=t(o.size,s[2]);s[0]&&u<s[0]&&(r=!0),s[1]&&u>s[1]&&(l=!0)}return r||l?(this.settings.messages[i.name]||(this.settings.messages[i.name]={},this.settings.messages[i.name].min=this.defaultMessage(i,"filesizemin"),this.settings.messages[i.name].max=this.defaultMessage(i,"filesizemax"),this.settings.messages[i.name].both=this.defaultMessage(i,"filesize")),this.settings.messages[i.name].filesize=r&&!l?this.settings.messages[i.name].min:l&&!r?this.settings.messages[i.name].max:this.settings.messages[i.name].both,!1):!0},e.validator.format("File size must exceed the minimum of {0} {2}s, but not the maximum of {1} {2}s.")),e.fn.cbvalidate=function(e){return i[e]?i[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?this:i.init.apply(this,arguments)},e.fn.cbvalidate.defaults={init:!0,useData:!1,messages:null,settings:null}}(jQuery);